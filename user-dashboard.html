<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan de Vitalidad - Painel do Usu√°rio</title>
    <link rel="stylesheet" href="user-dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="user-manifest.json">
    <meta name="theme-color" content="#10B981">
    <meta name="application-name" content="Plan de Vitalidad">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Plan Vitalidad">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Crect width='512' height='512' rx='115' fill='%2310B981'/%3E%3Ctext x='256' y='350' font-size='280' text-anchor='middle' fill='white'%3Eüå±%3C/text%3E%3C/svg%3E">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#10B981">
    <meta name="msapplication-config" content="browserconfig.xml">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <div class="vitality-icon">V</div>
            </div>
            <div class="loading-text">Plan de Vitalidad</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <div class="logout-icon">üö™</div>
                <h3 id="logoutTitle">Cerrar Sesi√≥n</h3>
                <p id="logoutMessage">¬øEst√°s seguro de que deseas cerrar sesi√≥n?</p>
            </div>
            <div class="modal-actions">
                <button id="cancelLogout" class="btn-secondary">Cancelar</button>
                <button id="confirmLogout" class="btn-danger">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Notification Detail Modal -->
    <div id="notificationModal" class="modal hidden">
        <div class="modal-content notification-modal">
            <div class="modal-header">
                <div class="notification-modal-header">
                    <div class="notification-icon-wrapper">
                        <span id="notificationIcon" class="notification-icon">üîî</span>
                    </div>
                    <div class="notification-details">
                        <h3 id="notificationTitle">Notificaci√≥n</h3>
                        <p id="notificationTime" class="notification-timestamp"></p>
                    </div>
                </div>
                <button id="closeNotificationModal" class="close-btn">‚úï</button>
            </div>
            <div class="modal-body">
                <p id="notificationFullMessage" class="notification-full-text"></p>
                <div class="notification-actions">
                    <button id="goToSection" class="btn-primary">Ir a secci√≥n</button>
                    <button id="toggleNotificationRead" class="btn-secondary">Marcar como le√≠da</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Viewer Modal -->
    <div id="contentViewerModal" class="modal hidden">
        <div class="modal-content content-viewer-modal">
            <div class="modal-header">
                <div class="content-viewer-header">
                    <div class="content-info">
                        <h3 id="contentViewerTitle">Visualizador de Contenido</h3>
                        <p id="contentViewerSubtitle">Documento</p>
                    </div>
                    <div class="content-actions">
                        <button id="downloadContentBtn" class="action-btn download" title="Descargar">
                            <i class="fas fa-download"></i>
                        </button>
                        <button id="fullscreenContentBtn" class="action-btn fullscreen" title="Pantalla completa">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button id="closeContentViewer" class="action-btn close" title="Cerrar">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-body content-viewer-body">
                <!-- PDF Viewer -->
                <div id="pdfViewer" class="content-viewer pdf-viewer hidden">
                    <div class="pdf-controls">
                        <button id="pdfPrevPage" class="pdf-btn" title="P√°gina anterior">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="pdf-page-info">
                            <input type="number" id="currentPageInput" value="1" min="1">
                            <span> de </span>
                            <span id="totalPages">1</span>
                        </span>
                        <button id="pdfNextPage" class="pdf-btn" title="P√°gina siguiente">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <div class="pdf-zoom-controls">
                            <button id="pdfZoomOut" class="pdf-btn" title="Alejar">
                                <i class="fas fa-search-minus"></i>
                            </button>
                            <span id="pdfZoomLevel">100%</span>
                            <button id="pdfZoomIn" class="pdf-btn" title="Acercar">
                                <i class="fas fa-search-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="pdf-container">
                        <iframe id="pdfIframe" src="" width="100%" height="100%"></iframe>
                    </div>
                </div>

                <!-- Video Viewer -->
                <div id="videoViewer" class="content-viewer video-viewer hidden">
                    <video id="videoPlayer" controls width="100%" height="100%">
                        <source id="videoSource" src="" type="video/mp4">
                        Tu navegador no soporta el elemento de video.
                    </video>
                </div>

                <!-- Audio Viewer -->
                <div id="audioViewer" class="content-viewer audio-viewer hidden">
                    <div class="audio-player-container">
                        <div class="audio-cover">
                            <i class="fas fa-music"></i>
                        </div>
                        <div class="audio-info">
                            <h4 id="audioTitle">T√≠tulo del Audio</h4>
                            <p id="audioDuration">00:00</p>
                        </div>
                        <audio id="audioPlayer" controls width="100%">
                            <source id="audioSource" src="" type="audio/mpeg">
                            Tu navegador no soporta el elemento de audio.
                        </audio>
                        <div class="audio-transcript" id="audioTranscript">
                            <h5>Transcripci√≥n:</h5>
                            <p>La transcripci√≥n del audio aparecer√° aqu√≠...</p>
                        </div>
                    </div>
                </div>

                <!-- Image Viewer -->
                <div id="imageViewer" class="content-viewer image-viewer hidden">
                    <div class="image-container">
                        <img id="imageContent" src="" alt="Imagen">
                    </div>
                </div>

                <!-- Loading State -->
                <div id="contentLoading" class="content-loading">
                    <div class="loading-spinner"></div>
                    <p>Cargando contenido...</p>
                </div>

                <!-- Error State -->
                <div id="contentError" class="content-error hidden">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <h4>Error al cargar el contenido</h4>
                    <p>No se pudo cargar el archivo. Por favor, intenta nuevamente.</p>
                    <button class="btn-primary" onclick="retryContentLoad()">Reintentar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button id="menuToggle" class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 id="appTitle" class="app-title">Plan de Vitalidad</h1>
            </div>
            <div class="header-right">
                <button id="languageToggle" class="language-toggle">
                    <i class="fas fa-globe"></i>
                </button>
                <span id="currentLanguage" class="current-language">ES</span>
            </div>
        </header>

        <div class="app-body">
            <!-- Sidebar -->
            <aside id="sidebar" class="sidebar">
                <div class="sidebar-header">
                    <div class="user-profile">
                        <div class="user-avatar">SE</div>
                        <div class="user-info">
                            <h3 id="userGreeting">Plan de Vitalidad</h3>
                            <p id="userName">Sara Emanuelly</p>
                        </div>
                    </div>
                </div>

                <nav class="sidebar-nav">
                    <button class="nav-item active" data-tab="inicio">
                        <span class="nav-icon">üè†</span>
                        <span id="nav-inicio" class="nav-label">Inicio</span>
                    </button>
                    <button class="nav-item" data-tab="productos">
                        <span class="nav-icon">üìö</span>
                        <span id="nav-productos" class="nav-label">Mis Productos</span>
                    </button>
                    <button class="nav-item" data-tab="bonus">
                        <span class="nav-icon">üéÅ</span>
                        <span id="nav-bonus" class="nav-label">Mis B√≥nus</span>
                    </button>
                    <button class="nav-item" data-tab="desafios">
                        <span class="nav-icon">üèÜ</span>
                        <span id="nav-desafios" class="nav-label">Desaf√≠os</span>
                    </button>
                    <button class="nav-item" data-tab="tienda">
                        <span class="nav-icon">üõí</span>
                        <span id="nav-tienda" class="nav-label">Tienda</span>
                    </button>
                    <button class="nav-item" data-tab="notificaciones">
                        <span class="nav-icon">üîî</span>
                        <span id="nav-notificaciones" class="nav-label">Notificaciones</span>
                        <span id="notificationBadge" class="notification-badge">3</span>
                    </button>
                    <button class="nav-item" data-tab="soporte">
                        <span class="nav-icon">ü§ñ</span>
                        <span id="nav-soporte" class="nav-label">Soporte</span>
                    </button>
                    <button class="nav-item" data-tab="configuraciones">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span id="nav-configuraciones" class="nav-label">Configuraciones</span>
                    </button>
                </nav>

                <div class="sidebar-footer">
                    <button id="logoutBtn" class="logout-btn">
                        <span class="nav-icon">üö™</span>
                        <span id="nav-salir" class="nav-label">Salir</span>
                    </button>
                </div>
            </aside>

            <!-- Sidebar Overlay for Mobile -->
            <div id="sidebarOverlay" class="sidebar-overlay hidden"></div>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Save Message -->
                <div id="saveMessage" class="save-message hidden">
                    <div class="save-content">
                        <span class="save-icon">‚úÖ</span>
                        <span id="saveText">Cambios guardados exitosamente</span>
                    </div>
                </div>

                <!-- Tab Content: Inicio -->
                <div id="tab-inicio" class="tab-content active">
                    <div class="content-section">
                        <!-- Welcome Card -->
                        <div class="welcome-card">
                            <h2 id="welcomeMessage">¬°Hola, Sara Emanuelly üëã</h2>
                            <p id="currentDate" class="current-date"></p>
                            <div class="language-indicator">
                                <span id="languageIndicator" class="language-badge">üåê ES</span>
                            </div>
                        </div>

                        <!-- Commercial Carousel -->
                        <div class="commercial-carousel-container">
                            <div class="commercial-carousel" id="commercialCarousel">
                                <div class="carousel-track" id="carouselTrack">
                                    <!-- Banners will be dynamically inserted -->
                                </div>
                                <div class="carousel-controls">
                                    <button class="carousel-btn prev" id="carouselPrev">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button class="carousel-btn next" id="carouselNext">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                                <div class="carousel-indicators" id="carouselIndicators">
                                    <!-- Indicators will be dynamically inserted -->
                                </div>
                            </div>
                        </div>

                        <!-- Products Overview Section - Inspired by the example -->
                        <div class="products-overview-modern">
                            <!-- Featured Product Card (Large) -->
                            <div class="featured-product-card" onclick="openContentViewer('featured-partnership', 'Parceria Especial', 'https://example.com/partnership-info.pdf', 'pdf')">
                                <div class="featured-content">
                                    <div class="featured-image">
                                        <img src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?w=400&h=300&fit=crop&crop=center" alt="Parceria" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                        <div class="featured-fallback" style="display: none;">
                                            <i class="fas fa-handshake"></i>
                                        </div>
                                    </div>
                                    <div class="featured-overlay">
                                        <h3>QUER FAZER UMA PARCERIA COM NOSSA P√ÅGINA OFICIAL</h3>
                                        <p>@DOGINFLUENCER</p>
                                        <button class="featured-cta">CLIQUE AQUI</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Product Grid (2x2) -->
                            <div class="products-grid-modern">
                                <!-- Aulas -->
                                <div class="product-card-modern" onclick="openContentViewer('aulas-collection', 'Aulas Completas', 'https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4', 'video')">
                                    <div class="product-image">
                                        <img src="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=300&h=200&fit=crop&crop=center" alt="Aulas" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                        <div class="product-fallback" style="display: none;">
                                            <i class="fas fa-graduation-cap"></i>
                                        </div>
                                    </div>
                                    <div class="product-overlay">
                                        <h4>Aulas</h4>
                                        <div class="product-status available">
                                            <i class="fas fa-play-circle"></i>
                                            <span>Dispon√≠vel</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Planos Personalizados -->
                                <div class="product-card-modern" onclick="openContentViewer('planos-personalizados', 'Planos Personalizados', 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf', 'pdf')">
                                    <div class="product-image">
                                        <img src="https://images.unsplash.com/photo-1586281380349-632531db7ed4?w=300&h=200&fit=crop&crop=center" alt="Planos" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                        <div class="product-fallback" style="display: none;">
                                            <i class="fas fa-clipboard-list"></i>
                                        </div>
                                    </div>
                                    <div class="product-overlay">
                                        <h4>Planos Personalizados</h4>
                                        <div class="product-status available">
                                            <i class="fas fa-file-pdf"></i>
                                            <span>Dispon√≠vel</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- B√¥nus -->
                                <div class="product-card-modern bonus" onclick="openContentViewer('bonus-especial', 'B√¥nus Especial', 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf', 'pdf')">
                                    <div class="product-image">
                                        <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=300&h=200&fit=crop&crop=center" alt="B√¥nus" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                        <div class="product-fallback" style="display: none;">
                                            <i class="fas fa-gift"></i>
                                        </div>
                                    </div>
                                    <div class="product-overlay">
                                        <h4>B√¥nus</h4>
                                        <div class="product-status bonus-status">
                                            <i class="fas fa-star"></i>
                                            <span>Liberado em 7 dias</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Dog IA -->
                                <div class="product-card-modern locked" onclick="showLockedMessage()">
                                    <div class="product-image">
                                        <img src="https://images.unsplash.com/photo-1552053831-71594a27632d?w=300&h=200&fit=crop&crop=center" alt="Dog IA" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                        <div class="product-fallback" style="display: none;">
                                            <i class="fas fa-robot"></i>
                                        </div>
                                    </div>
                                    <div class="product-overlay">
                                        <h4>Dog IA</h4>
                                        <div class="product-status locked">
                                            <i class="fas fa-lock"></i>
                                            <span>Bloqueado</span>
                                        </div>
                                    </div>
                                    <div class="lock-overlay">
                                        <i class="fas fa-lock"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Card -->
                        <div class="progress-card">
                            <div class="progress-header">
                                <h3 id="progressTitle">Tu Progreso</h3>
                                <span class="progress-badge">Activo</span>
                            </div>
                            <div class="progress-details">
                                <div class="progress-info">
                                    <span>D√≠a 4 de 7</span>
                                    <span class="progress-percentage">57% Completado üéâ</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 57%"></div>
                                </div>
                                <button id="viewChallenge" class="btn-primary" data-tab="desafios">Ver desaf√≠o</button>
                            </div>
                        </div>

                        <!-- Continue Where You Left Off -->
                        <div class="continue-card">
                            <h3 id="continueTitle">Contin√∫a donde lo dejaste</h3>
                            <div class="continue-content">
                                <div class="continue-icon">üìñ</div>
                                <div class="continue-details">
                                    <h4 id="lastAccessTitle">√öltimo acceso: eBook Nutrici√≥n Vital</h4>
                                    <p class="continue-subtitle">Cap√≠tulo 3: Alimentaci√≥n consciente</p>
                                    <div class="continue-progress">
                                        <div class="continue-progress-bar">
                                            <div class="continue-progress-fill" style="width: 75%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button id="continueReading" class="btn-primary" onclick="openContentViewer('ebook-nutricion-vital', 'Nutrici√≥n Vital', 'https://example.com/nutrition-ebook.pdf', 'pdf')">Continuar</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Productos -->
                <div id="tab-productos" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="productosTitle">Mis Productos</h2>
                            <span class="section-badge">6 productos liberados</span>
                        </div>

                        <!-- Filters Card -->
                        <div class="filters-card">
                            <h3 id="filtersTitle">Filtrar por</h3>
                            <div class="search-bar">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="productSearch" placeholder="Buscar producto...">
                            </div>
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label id="typeLabel">Tipo</label>
                                    <select id="typeFilter">
                                        <option value="all">Todos los tipos</option>
                                        <option value="eBook">üìñ eBook</option>
                                        <option value="Video">üé• Video</option>
                                        <option value="Planner">üìã Planner</option>
                                        <option value="Guia">üìò Guia</option>
                                        <option value="Aula">üéì Aula</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label id="languageLabel">Idioma</label>
                                    <select id="languageFilter">
                                        <option value="all">Todos los idiomas</option>
                                        <option value="es">üá™üá∏ Espa√±ol</option>
                                        <option value="pt">üáßüá∑ Portugu√™s</option>
                                        <option value="en">üá∫üá∏ English</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Products List -->
                        <div id="productsList" class="products-list">
                            <!-- Products will be dynamically inserted here -->
                        </div>

                        <!-- No Products Message -->
                        <div id="noProductsMessage" class="empty-state hidden">
                            <div class="empty-icon">üìã</div>
                            <h3 id="noContentTitle">Ning√∫n contenido disponible en el filtro actual</h3>
                            <p id="noContentSubtitle">Intenta ajustar los filtros o explora nuestra tienda</p>
                            <button class="btn-primary" data-tab="tienda">¬°Confira nuestra tienda para nuevos contenidos!</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Bonus -->
                <div id="tab-bonus" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="bonusTitle">Mis B√≥nus</h2>
                            <div class="bonus-badges">
                                <span class="section-badge green">2 b√≥nus liberados</span>
                                <span class="section-badge blue">4 pr√≥ximos b√≥nus</span>
                            </div>
                        </div>

                        <!-- Released Bonuses -->
                        <div class="bonus-section">
                            <h3 class="bonus-section-title">
                                <span class="bonus-icon green">‚úÖ</span>
                                <span id="releasedBonusTitle">B√≥nus Liberados</span>
                            </h3>
                            <div id="releasedBonusList" class="bonus-list">
                                <!-- Released bonuses will be inserted here -->
                            </div>
                        </div>

                        <!-- Upcoming Bonuses -->
                        <div class="bonus-section">
                            <h3 class="bonus-section-title">
                                <span class="bonus-icon blue">‚è∞</span>
                                <span id="upcomingBonusTitle">Pr√≥ximos B√≥nus</span>
                            </h3>
                            <div id="upcomingBonusList" class="bonus-list">
                                <!-- Upcoming bonuses will be inserted here -->
                            </div>
                        </div>

                        <!-- Points Summary -->
                        <div class="points-card">
                            <div class="points-icon">üèÜ</div>
                            <div class="points-content">
                                <h3 id="pointsTitle">Tus Puntos de Vitalidad</h3>
                                <p id="pointsSubtitle">Completa desaf√≠os para ganar m√°s puntos</p>
                            </div>
                            <div class="points-value">
                                <div class="points-number">120</div>
                                <div class="points-label">puntos</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Desafios -->
                <div id="tab-desafios" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="desafiosTitle">Desaf√≠os</h2>
                            <span class="section-badge">D√≠a 4/7</span>
                        </div>

                        <!-- Active Challenge -->
                        <div class="challenge-card">
                            <div class="challenge-header">
                                <div class="challenge-info">
                                    <h3 class="challenge-name">Semana de Vitalidad Total</h3>
                                    <p class="challenge-duration">7 d√≠as totales</p>
                                </div>
                                <div class="challenge-progress-circle">
                                    <div class="progress-value">57%</div>
                                    <div class="progress-label">Completado</div>
                                </div>
                            </div>
                            
                            <div class="challenge-progress-section">
                                <div class="challenge-progress-info">
                                    <span>D√≠a 4 de 7</span>
                                    <span>3 d√≠as restantes</span>
                                </div>
                                <div class="challenge-progress-bar">
                                    <div class="challenge-progress-fill" style="width: 57%">
                                        <div class="progress-indicator"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="challenge-dates">
                                <div class="challenge-date">
                                    <span class="date-label">In√≠cio:</span>
                                    <span class="date-value">25 dic</span>
                                </div>
                                <div class="challenge-date">
                                    <span class="date-label">Fim:</span>
                                    <span class="date-value">31 dic</span>
                                </div>
                            </div>
                        </div>

                        <!-- Daily Tasks -->
                        <div class="tasks-card">
                            <div class="tasks-header">
                                <h3 class="tasks-title">
                                    <span class="tasks-icon">üìÖ</span>
                                    <span id="dailyTasksTitle">Tareas de Hoy</span>
                                </h3>
                                <div class="tasks-counter">
                                    <span id="tasksCompleted">2</span>/<span id="tasksTotal">5</span> completadas
                                </div>
                            </div>

                            <div id="tasksList" class="tasks-list">
                                <!-- Tasks will be inserted here -->
                            </div>

                            <div id="tasksCompleteMessage" class="tasks-complete hidden">
                                <div class="complete-icon">üéâ</div>
                                <h4 id="completeTitle">¬°Bien hecho! D√≠a completado</h4>
                                <p>¬°Sigue as√≠! Est√°s un d√≠a m√°s cerca de tu objetivo.</p>
                            </div>

                            <button id="viewRewards" class="btn-gradient" data-tab="bonus">
                                <span>üèÜ</span>
                                <span id="rewardsText">Ver recompensas</span>
                            </button>
                        </div>

                        <!-- Notifications Toggle -->
                        <div class="notifications-card">
                            <div class="notifications-content">
                                <div class="notifications-icon">üîî</div>
                                <div class="notifications-text">
                                    <h3 id="activateNotificationsTitle">Activar notificaciones</h3>
                                    <p id="dailyRemindersText">Para recordatorios diarios</p>
                                </div>
                            </div>
                            <div class="toggle-switch">
                                <input type="checkbox" id="notificationsToggle" class="toggle-input">
                                <label for="notificationsToggle" class="toggle-label"></label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Tienda -->
                <div id="tab-tienda" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="tiendaTitle">Tienda</h2>
                            <span class="section-badge">8 productos</span>
                        </div>

                        <!-- Store Filters -->
                        <div class="filters-card">
                            <h3 id="storeCategoryTitle">Filtrar por categor√≠a</h3>
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label>Categor√≠a</label>
                                    <select id="categoryFilter">
                                        <option value="all">Todas las categor√≠as</option>
                                        <option value="alimentacionSaludable">ü•ó Alimentaci√≥n saludable</option>
                                        <option value="habitos">üéØ H√°bitos</option>
                                        <option value="desafiosCategoria">üèÜ Desaf√≠os</option>
                                        <option value="extras">‚ú® Extras</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Idioma</label>
                                    <select id="storeLanguageFilter">
                                        <option value="all">Todos los idiomas</option>
                                        <option value="es">üá™üá∏ Espa√±ol</option>
                                        <option value="pt">üáßüá∑ Portugu√™s</option>
                                        <option value="en">üá∫üá∏ English</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Flash Sale Banner -->
                        <div id="flashSaleBanner" class="flash-sale-banner">
                            <div class="flash-sale-content">
                                <h3>üî• Oferta rel√°mpago</h3>
                                <p>Aprovecha estos descuentos por tiempo limitado</p>
                            </div>
                            <div class="flash-sale-icon">‚è∞</div>
                        </div>

                        <!-- Featured Products -->
                        <div id="featuredProducts" class="featured-products">
                            <h3 id="featuredProductsTitle">‚ú® Productos Destacados</h3>
                            <div class="featured-products-grid" id="featuredProductsGrid">
                                <!-- Featured products will be inserted here -->
                            </div>
                        </div>

                        <!-- Store Products Grid -->
                        <div id="storeProductsGrid" class="store-products-grid">
                            <!-- Store products will be inserted here -->
                        </div>

                        <!-- Empty Store State -->
                        <div id="emptyStoreState" class="empty-state" style="display: none;">
                            <div class="empty-icon">üõçÔ∏è</div>
                            <h3 id="emptyStoreTitle">No hay productos disponibles</h3>
                            <p id="emptyStoreSubtitle">Pronto tendremos nuevos productos para ti</p>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Notificaciones -->
                <div id="tab-notificaciones" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="notificacionesTitle">Notificaciones</h2>
                            <div class="notifications-badges">
                                <span class="section-badge red">3 no le√≠das</span>
                                <span class="section-badge gray">6 total</span>
                            </div>
                        </div>

                        <!-- Notification Filters -->
                        <div class="filters-card">
                            <h3 id="notificationFiltersTitle">Filtrar por tipo</h3>
                            <div class="filter-row">
                                <div class="filter-group">
                                    <label>Tipo de notificaci√≥n</label>
                                    <select id="notificationTypeFilter">
                                        <option value="all">Todas las notificaciones</option>
                                        <option value="desafios">üèÜ Desaf√≠os</option>
                                        <option value="productos">üìö Productos</option>
                                        <option value="bonus">üéÅ B√≥nus</option>
                                        <option value="alertas">‚ö†Ô∏è Alertas</option>
                                    </select>
                                </div>
                                <div class="filter-group checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="unreadOnlyFilter">
                                        <span class="checkmark"></span>
                                        <span id="unreadOnlyText">Solo no le√≠das</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Notifications List -->
                        <div id="notificationsList" class="notifications-list">
                            <!-- Notifications will be inserted here -->
                        </div>

                        <!-- Quick Stats -->
                        <div class="notifications-stats">
                            <button class="stat-card bonus" data-filter="bonus">
                                <div class="stat-icon">üéÅ</div>
                                <div class="stat-value">2</div>
                                <div class="stat-label">bonus</div>
                            </button>
                            <button class="stat-card desafios" data-filter="desafios">
                                <div class="stat-icon">üèÜ</div>
                                <div class="stat-value">2</div>
                                <div class="stat-label">desafios</div>
                            </button>
                            <button class="stat-card productos" data-filter="productos">
                                <div class="stat-icon">üìö</div>
                                <div class="stat-value">1</div>
                                <div class="stat-label">productos</div>
                            </button>
                            <button class="stat-card alertas" data-filter="alertas">
                                <div class="stat-icon">‚ö†Ô∏è</div>
                                <div class="stat-value">1</div>
                                <div class="stat-label">alertas</div>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Soporte -->
                <div id="tab-soporte" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="soporteTitle">Soporte</h2>
                            <span class="section-badge">Tiempo de respuesta promedio: 2-5 minutos</span>
                        </div>

                        <!-- Support Form -->
                        <div class="support-form-card">
                            <h3>Nueva Consulta</h3>
                            
                            <div class="form-group">
                                <label id="questionTypeLabel">Tipo de duda</label>
                                <select id="questionType">
                                    <option value="">Seleccionar tipo de duda</option>
                                    <option value="tecnico">üîß T√©cnico</option>
                                    <option value="contenido">üìö Contenido</option>
                                    <option value="acceso">üîë Acceso</option>
                                    <option value="otro">‚ùì Otro</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label id="questionLabel">Tu pregunta</label>
                                <textarea id="supportQuestion" placeholder="Escribe tu duda aqu√≠..." rows="4"></textarea>
                            </div>

                            <div class="audio-section">
                                <label id="audioLabel">Mensaje de voz (opcional)</label>
                                <div id="audioControls" class="audio-controls">
                                    <button id="recordBtn" class="record-btn">
                                        <span class="record-icon">üé§</span>
                                        <span id="recordText">Enviar audio</span>
                                    </button>
                                    <div id="recordingStatus" class="recording-status hidden">
                                        <div class="recording-indicator"></div>
                                        <span>Grabando...</span>
                                    </div>
                                </div>
                                <div id="audioPlayback" class="audio-playback hidden">
                                    <div class="audio-info">
                                        <div class="audio-icon">üéµ</div>
                                        <div class="audio-details">
                                            <p>Audio enviado con √©xito</p>
                                            <p class="audio-description">Mensaje de voz adjunto</p>
                                        </div>
                                    </div>
                                    <div class="audio-actions">
                                        <button id="playAudioBtn" class="audio-action-btn">‚ñ∂</button>
                                        <button id="deleteAudioBtn" class="audio-action-btn delete">üóë</button>
                                    </div>
                                </div>
                            </div>

                            <button id="submitSupport" class="btn-primary submit-btn" disabled>
                                <span>üí¨</span>
                                <span id="submitText">Enviar</span>
                            </button>
                        </div>

                        <!-- AI Processing Message -->
                        <div id="aiProcessing" class="ai-processing hidden">
                            <div class="ai-icon">ü§ñ</div>
                            <div class="ai-content">
                                <h3>Asistente IA</h3>
                                <p>Estamos analizando tu pregunta. Aqu√≠ tienes algo que puede ayudarte...</p>
                            </div>
                            <div class="ai-loading">
                                <div class="dot"></div>
                                <div class="dot"></div>
                                <div class="dot"></div>
                            </div>
                        </div>

                        <!-- Support History -->
                        <div class="support-history">
                            <h3 class="history-title">
                                <span class="history-icon">üìã</span>
                                <span id="historyTitle">Historial de Dudas</span>
                            </h3>
                            <div id="supportHistoryList" class="history-list">
                                <!-- Support history will be inserted here -->
                            </div>
                            <div id="noSupportHistory" class="empty-state">
                                <div class="empty-icon">üí¨</div>
                                <h3>A√∫n no has enviado ninguna duda</h3>
                                <p>Hazle tu primera pregunta a nuestro equipo de soporte</p>
                            </div>
                        </div>

                        <!-- Support Info Cards -->
                        <div class="support-info-cards">
                            <div class="info-card ai">
                                <div class="info-icon">ü§ñ</div>
                                <div class="info-content">
                                    <h3>Asistente IA</h3>
                                    <p>Respuestas instant√°neas 24/7</p>
                                </div>
                            </div>
                            <div class="info-card human">
                                <div class="info-icon">üë•</div>
                                <div class="info-content">
                                    <h3>Equipo de Soporte</h3>
                                    <p>Soporte humano especializado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab Content: Configuraciones -->
                <div id="tab-configuraciones" class="tab-content">
                    <div class="content-section">
                        <div class="section-header">
                            <h2 id="configuracionesTitle">Configuraciones</h2>
                        </div>

                        <!-- General Settings -->
                        <div class="settings-card">
                            <h3 class="settings-title">
                                <span class="settings-icon">‚öôÔ∏è</span>
                                <span id="generalSettingsTitle">Configuraci√≥n general</span>
                            </h3>

                            <!-- Language Settings -->
                            <div class="setting-section">
                                <div class="setting-header">
                                    <div class="setting-info">
                                        <div class="setting-icon">üåê</div>
                                        <div class="setting-text">
                                            <h4 id="languageSettingTitle">Idioma</h4>
                                            <p id="currentLanguageText">Idioma actual: Espa√±ol</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="language-options">
                                    <button class="language-option active" data-lang="es">
                                        <span class="flag">üá™üá∏</span>
                                        <div class="language-info">
                                            <div class="language-name">Espa√±ol</div>
                                            <div class="language-country">Espa√±a</div>
                                        </div>
                                        <div class="language-check">‚úì</div>
                                    </button>
                                    <button class="language-option" data-lang="pt">
                                        <span class="flag">üáßüá∑</span>
                                        <div class="language-info">
                                            <div class="language-name">Portugu√™s</div>
                                            <div class="language-country">Brasil</div>
                                        </div>
                                    </button>
                                    <button class="language-option" data-lang="en">
                                        <span class="flag">üá∫üá∏</span>
                                        <div class="language-info">
                                            <div class="language-name">English</div>
                                            <div class="language-country">United States</div>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Personalization Settings -->
                        <div class="settings-card">
                            <h3 class="settings-title">
                                <span class="settings-icon">üé®</span>
                                <span id="personalizationTitle">Personalizar</span>
                            </h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-icon dark-mode">üåô</div>
                                    <div class="setting-text">
                                        <h4 id="darkModeTitle">Activar modo oscuro</h4>
                                        <p id="darkModeDesc">Modo claro</p>
                                    </div>
                                </div>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="darkModeToggle" class="toggle-input">
                                    <label for="darkModeToggle" class="toggle-label"></label>
                                </div>
                            </div>
                        </div>

                        <!-- Notification Settings -->
                        <div class="settings-card">
                            <h3 class="settings-title">
                                <span class="settings-icon">üîî</span>
                                <span id="notificationSettingsTitle">Notificaciones</span>
                            </h3>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-icon">üì±</div>
                                    <div class="setting-text">
                                        <h4 id="pushNotificationsTitle">Recibir notificaciones push</h4>
                                        <p>Recibir alertas y recordatorios importantes</p>
                                    </div>
                                </div>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="pushNotificationsToggle" class="toggle-input" checked>
                                    <label for="pushNotificationsToggle" class="toggle-label"></label>
                                </div>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-icon">üîä</div>
                                    <div class="setting-text">
                                        <h4 id="soundNotificationsTitle">Sonidos de notificaciones</h4>
                                        <p>Reproducir sonidos cuando lleguen notificaciones</p>
                                    </div>
                                </div>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="soundNotificationsToggle" class="toggle-input" checked>
                                    <label for="soundNotificationsToggle" class="toggle-label"></label>
                                </div>
                            </div>
                        </div>

                        <!-- Account Data -->
                        <div class="settings-card">
                            <h3 class="settings-title">
                                <span class="settings-icon">üë§</span>
                                <span id="accountDataTitle">Datos de la cuenta</span>
                            </h3>

                            <div class="user-profile-card">
                                <div class="profile-avatar">SE</div>
                                <div class="profile-info">
                                    <h4>Sara Emanuelly</h4>
                                    <p>Plan de Vitalidad Premium</p>
                                    <div class="profile-status">
                                        <span class="status-indicator"></span>
                                        <span>Activa</span>
                                    </div>
                                </div>
                            </div>

                            <div class="account-details">
                                <div class="account-field">
                                    <div class="field-icon">üìß</div>
                                    <div class="field-content">
                                        <span class="field-label">Email</span>
                                        <span class="field-value">sara.emanuelly@email.com</span>
                                    </div>
                                </div>
                                <div class="account-field">
                                    <div class="field-icon">üìÖ</div>
                                    <div class="field-content">
                                        <span class="field-label">Fecha de registro</span>
                                        <span class="field-value">15 de dezembro, 2024</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Security Settings -->
                        <div class="settings-card danger">
                            <h3 class="settings-title">
                                <span class="settings-icon">üîí</span>
                                <span id="securityTitle">Seguridad y privacidad</span>
                            </h3>

                            <div class="logout-section">
                                <div class="logout-info">
                                    <div class="logout-icon-setting">üö™</div>
                                    <div class="logout-text">
                                        <h4 id="logoutSettingTitle">Cerrar sesi√≥n</h4>
                                        <p>Cerrar sesi√≥n en este dispositivo</p>
                                    </div>
                                </div>
                                <button id="logoutSettingBtn" class="btn-danger">Salir</button>
                            </div>
                        </div>

                        <!-- App Info -->
                        <div class="settings-card">
                            <h3 class="settings-title">
                                <span class="settings-icon">‚ÑπÔ∏è</span>
                                <span>Informaci√≥n de la App</span>
                            </h3>

                            <div class="app-info">
                                <div class="info-field">
                                    <div class="field-icon">üì±</div>
                                    <div class="field-content">
                                        <span class="field-label">Versi√≥n</span>
                                        <span class="field-value">v2.1.0</span>
                                    </div>
                                </div>
                                <div class="info-field">
                                    <div class="field-icon">‚öñÔ∏è</div>
                                    <div class="field-content">
                                        <span class="field-label">Aviso legal</span>
                                        <button class="link-btn">Ver t√©rminos y condiciones</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Support Link -->
                        <div class="support-link-card">
                            <div class="support-link-icon">ü§ù</div>
                            <div class="support-link-content">
                                <h3>¬øNecesitas ayuda?</h3>
                                <p>Nuestro equipo de soporte est√° aqu√≠ para ayudarte</p>
                            </div>
                            <button class="btn-primary" data-tab="soporte">Contactar soporte</button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <p id="footerText">App Plan de Vitalidad ‚Äì Uso personal. Derechos reservados.</p>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="shared-data.js"></script>
    <script src="auth.js"></script>
    <script src="user-dashboard.js"></script>
    
    <!-- PWA Installation and Service Worker -->
    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/user-service-worker.js')
                    .then((registration) => {
                        console.log('üå± User SW registered: ', registration);
                    })
                    .catch((error) => {
                        console.log('üå± User SW registration failed: ', error);
                    });
            });
        }
        
        // PWA Installation Banner
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üå± PWA: beforeinstallprompt event fired');
            e.preventDefault();
            deferredPrompt = e;
            showInstallBanner();
        });
        
        function showInstallBanner() {
            const installBanner = document.createElement('div');
            installBanner.id = 'install-banner';
            installBanner.innerHTML = `
                <div class="install-banner-content">
                    <div class="install-banner-icon">üå±</div>
                    <div class="install-banner-text">
                        <strong>Instalar Plan de Vitalidad</strong>
                        <p>Accede m√°s r√°pido a tu dashboard</p>
                    </div>
                    <button class="install-banner-btn" onclick="installPWA()">
                        <i class="fas fa-download"></i> Instalar
                    </button>
                    <button class="install-banner-close" onclick="closeInstallBanner()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            const bannerCSS = `
                <style>
                    #install-banner {
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        background: linear-gradient(135deg, #10B981 0%, #059669 100%);
                        color: white;
                        padding: 12px 16px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        z-index: 10000;
                        transform: translateY(-100%);
                        transition: transform 0.3s ease;
                    }
                    
                    #install-banner.show {
                        transform: translateY(0);
                    }
                    
                    .install-banner-content {
                        display: flex;
                        align-items: center;
                        gap: 12px;
                        max-width: 1200px;
                        margin: 0 auto;
                    }
                    
                    .install-banner-icon {
                        font-size: 24px;
                        flex-shrink: 0;
                    }
                    
                    .install-banner-text {
                        flex: 1;
                        min-width: 0;
                    }
                    
                    .install-banner-text strong {
                        display: block;
                        font-size: 16px;
                        margin-bottom: 2px;
                    }
                    
                    .install-banner-text p {
                        font-size: 14px;
                        opacity: 0.9;
                        margin: 0;
                    }
                    
                    .install-banner-btn {
                        background: rgba(255,255,255,0.2);
                        border: 1px solid rgba(255,255,255,0.3);
                        color: white;
                        padding: 8px 16px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-size: 14px;
                        display: flex;
                        align-items: center;
                        gap: 6px;
                        transition: all 0.2s;
                        flex-shrink: 0;
                    }
                    
                    .install-banner-btn:hover {
                        background: rgba(255,255,255,0.3);
                        border-color: rgba(255,255,255,0.5);
                    }
                    
                    .install-banner-close {
                        background: none;
                        border: none;
                        color: white;
                        font-size: 16px;
                        cursor: pointer;
                        padding: 4px;
                        opacity: 0.7;
                        border-radius: 4px;
                        transition: opacity 0.2s;
                        flex-shrink: 0;
                    }
                    
                    .install-banner-close:hover {
                        opacity: 1;
                    }
                    
                    @media (max-width: 768px) {
                        .install-banner-content {
                            gap: 8px;
                        }
                        
                        .install-banner-text strong {
                            font-size: 14px;
                        }
                        
                        .install-banner-text p {
                            font-size: 12px;
                        }
                        
                        .install-banner-btn {
                            font-size: 12px;
                            padding: 6px 12px;
                        }
                    }
                </style>
            `;
            
            document.head.insertAdjacentHTML('beforeend', bannerCSS);
            document.body.insertAdjacentElement('afterbegin', installBanner);
            
            // Show banner with animation
            setTimeout(() => {
                installBanner.classList.add('show');
            }, 100);
        }
        
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('üå± PWA: User accepted the install prompt');
                        closeInstallBanner();
                    } else {
                        console.log('üå± PWA: User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                });
            }
        }
        
        function closeInstallBanner() {
            const banner = document.getElementById('install-banner');
            if (banner) {
                banner.classList.remove('show');
                setTimeout(() => {
                    banner.remove();
                }, 300);
            }
        }
        
        // Handle successful installation
        window.addEventListener('appinstalled', (evt) => {
            console.log('üå± PWA: App was installed successfully');
            closeInstallBanner();
        });
        
        // Handle updates
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                window.location.reload();
            });
        }
    </script>
    <script>
        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üå± Verificando autentica√ß√£o...');
            
            try {
                // Check authentication
                if (!authSystem.isLoggedIn() || authSystem.getCurrentUser()?.role !== 'user') {
                    console.log('‚ùå Usu√°rio n√£o autenticado, redirecionando...');
                    window.location.href = 'app-login.html';
                    return;
                }

                console.log('‚úÖ Usu√°rio autenticado:', authSystem.getCurrentUser());
                
                // Initialize dashboard
                initializeUserDashboard();
                
            } catch (error) {
                console.error('Erro na inicializa√ß√£o:', error);
                // For√ßar remo√ß√£o da tela de carregamento em caso de erro
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loadingScreen');
                    if (loadingScreen) {
                        loadingScreen.style.display = 'none';
                    }
                }, 2000);
            }
        });
    </script>
</body>
</html>